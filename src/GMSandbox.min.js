!function(e){"use strict";var t=function(o){if(this.initDone=!1,this.instance=null,this.mapOptions=null,this.element=null,this.userInitCallback=null,this.geoService=null,this.markers=[],this.mousePosition={},this.zoomLevel=13,o)try{o instanceof google.maps.Map&&(this.instance=o,this.element=document.querySelector(o.element),this.geoService=new e.google.maps.Geocoder,this.CustomizedMarker=t.CustomizedMarker=this.initClasses(e.google),google.maps.event.addListener(this.instance,"mousemove",this._mapMouseMoveHandler.bind(this)),this.initDone=!0,t.registInstance.push(this))}catch(n){throw"Invalid Map Object: "+o}};t.registInstance=[],t.initCallback=function(o){if(!e.google){if(o)return;throw"Google Map Javascript API Not Found!"}for(var n=0,i=t.registInstance.length;i>n;n++){var s=t.registInstance[n];s.initDone||(s.geoService=new e.google.maps.Geocoder,s.instance=new e.google.maps.Map(s.element,s.mapOptions),s.CustomizedMarker=t.CustomizedMarker=s.initClasses(e.google),google.maps.event.addListener(s.instance,"mousemove",s._mapMouseMoveHandler.bind(s)),s.instance.setMapTypeId(google.maps.MapTypeId[s.mapOptions.mapType]),"function"==typeof s.userInitCallback&&s.userInitCallback(s.instance),s.initDone=!0)}},t.prototype.init=function(e,o){if(!this.instance){var n="",i=!1,s=!1;switch(arguments.length){case 0:throw"An DOM Element Is Needed To Initialize Google Map";case 1:if("string"==typeof e){if(!document.querySelector(e))throw"An DOM Element Is Needed To Initialize Google Map"}else if(!this._isElement(e)&&!document.querySelector(e.element)&&!this._isElement(e.element))throw"An DOM Element Is Needed To Initialize Google Map";i=null==e.apiKey,s=!0;break;case 2:if("string"==typeof e){if(!document.querySelector(e))throw"An DOM Element Is Needed To Initialize Google Map"}else if(!this._isElement(e)&&!document.querySelector(e.element)&&!this._isElement(e.element))throw"An DOM Element Is Needed To Initialize Google Map";i=null==e.apiKey,s="function"!=typeof o;break;default:throw"Wrong Augments Number"}n=i?"http://maps.googleapis.com/maps/api/js?v=3&callback=GMSandbox.initCallback&signed_in=true":"http://maps.googleapis.com/maps/api/js?v=3&callback=GMSandbox.initCallback&key="+e.apiKey;var a=document.createElement("script");a.id="GMSandbox_Google_Map_API",a.type="text/javascript",a.src=n,this.mapOptions=this._defineOptions(e),this.userInitCallback=o,this.element="string"==typeof e?document.querySelector(e):this._isElement(e)?e:"string"==typeof e.element?document.querySelector(e.element):e.element,t.registInstance.push(this);try{document.querySelector("#GMSandbox_Google_Map_API")||document.head.appendChild(a)}catch(r){throw"Failed to initialize Google Map: "+r}t.initCallback(!0)}},t.prototype.initClasses=function(e){var t=function(t,o,n,i,s){var a=document.createElement("div");a.style.position="absolute",a.innerHTML=t,e.maps.event.addDomListener(a,"mousedown",function(e){this._dragMarker(e)}.bind(this)),this.draggable=s||!1,this.anchor=i||"bottomCenter",this.template=a,this.position=o,this.parent=n,this.setMap(n.instance)};return t.prototype=new e.maps.OverlayView,t.prototype._dragMarker=function(t){if(this.draggable){event.preventDefault(),event.stopPropagation();var o=t.clientY,n=t.clientX,i=this.template,s=o-i.offsetTop,a=n-i.offsetLeft,r=e.maps.event.addListener(this.parent.instance,"mousemove",function(e){this.template.style.top=e.pixel.y-s+"px",this.template.style.left=e.pixel.x-a+"px"}.bind(this));e.maps.event.addListenerOnce(this.parent.instance,"mouseup",function(){e.maps.event.removeListener(r),this._domPositionToLatLng()}.bind(this))}},t.prototype._domPositionToLatLng=function(){var t=this.template,o={},n=this.anchor;switch(n.toLowerCase()){case"bottomcenter":o.y=t.offsetTop+t.offsetHeight,o.x=t.offsetLeft+t.offsetWidth/2;break;case"center":o.y=t.offsetTop+t.offsetHeight/2,o.x=t.offsetLeft+t.offsetWidth/2;break;case"topcenter":o.y=t.offsetTop,o.x=t.offsetLeft+t.offsetWidth/2;break;case"leftcenter":o.y=t.offsetTop+t.offsetHeight/2,o.x=t.offsetLeft;break;case"rightcenter":o.y=t.offsetTop+t.offsetHeight/2,o.x=t.offsetLeft+t.offsetWidth;break;case"topleft":o.y=t.offsetTop,o.x=t.offsetLeft;break;case"topright":o.y=t.offsetTop,o.x=t.offsetLeft+t.offsetWidth;break;case"bottomleft":o.y=t.offsetTop+t.offsetHeight,o.x=t.offsetLeft;break;case"bottomright":o.y=t.offsetTop+t.offsetHeight,o.x=t.offsetLeft+t.offsetWidth;break;default:o.y=t.offsetTop+t.offsetHeight,o.x=t.offsetLeft+t.offsetWidth/2}var i=this.getProjection(),s=new e.maps.Point(o.x,o.y);this.position=i.fromDivPixelToLatLng(s)},t.prototype._latLngToDomPosition=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this.position),o=this.template,n=this.anchor.toLowerCase();switch(n){case"bottomcenter":o.style.left=t.x-o.offsetWidth/2+"px",o.style.top=t.y-o.offsetHeight+"px";break;case"center":o.style.left=t.x-o.offsetWidth/2+"px",o.style.top=t.y-o.offsetHeight/2+"px";break;case"topcenter":o.style.left=t.x-o.offsetWidth/2+"px",o.style.top=t.y+"px";break;case"leftcenter":o.style.left=t.x+"px",o.style.top=t.y-o.offsetHeight/2+"px";break;case"rightcenter":o.style.left=t.x-o.offsetWidth+"px",o.style.top=t.y-o.offsetHeight/2+"px";break;case"topleft":o.style.left=t.x+"px",o.style.top=t.y+"px";break;case"topright":o.style.left=t.x-o.offsetWidth+"px",o.style.top=t.y+"px";break;case"bottomleft":o.style.left=t.x+"px",o.style.top=t.y-o.offsetHeight+"px";break;case"bottomright":o.style.left=t.x-o.offsetWidth+"px",o.style.top=t.y-o.offsetHeight+"px";break;default:o.style.left=t.x-o.offsetWidth/2+"px",o.style.top=t.y-o.offsetHeight+"px"}},t.prototype.onAdd=function(){var e=this.getPanes();e.overlayMouseTarget.appendChild(this.template)},t.prototype.draw=function(){this._latLngToDomPosition()},t.prototype.onRemove=function(){this.template.parentNode.removeChild(this.template)},t},t.prototype._mapMouseMoveHandler=function(e){this.mousePosition=e.latLng},t.prototype._isElement=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},t.prototype._defineOptions=function(e){var t={mapType:"ROADMAP",zoom:8,center:{lat:42.358421,lng:-71.060934},panControl:!1,streetViewControl:!1,disableDoubleClickZoom:!0,mapTypeControl:!1};if("string"==typeof e||this._isElement(e))return t;var o=e.mapType.toUpperCase();return e.mapType="ROADMAP"===o||"SATELLITE"===o||"TERRAIN"===o||"HYBRID"===o?o:"ROADMAP",e.zoom=void 0===e.zoom||null===e.zoom?8:e.zoom,e.center=void 0===e.center||null===e.center?{lat:42.358421,lng:-71.060934}:e.center,e.panControl=void 0===e.panControl||null===e.panControl?!1:e.panControl,e.streetViewControl=void 0===e.streetViewControl||null===e.streetViewControl?!1:e.streetViewControl,e.disableDoubleClickZoom=void 0===e.disableDoubleClickZoom||null===e.disableDoubleClickZoom?!0:e.disableDoubleClickZoom,e.mapTypeControl=void 0===e.mapTypeControl||null===e.mapTypeControl?!1:e.mapTypeControl,e},t.prototype._parselocation=function(e,t){this.geoService.geocode(e,function(e,o){if(o!=google.maps.GeocoderStatus.OK)throw"Geocode was not successful for the following reason: "+o;var n=e[0].geometry.location;t(n)})},t.prototype._defineLocation=function(e){var t=null,o=null;return"object"==typeof e&&(o="location",t={},t.lat=e.lat,t.lng=e.lng),"string"==typeof e&&(o="address",t=e),{type:o,location:t}},t.prototype._defineLable=function(e){var t=e;return"object"==typeof e&&(e.fontFamily&&(t.fontFamily=e.fontFamily),e.fontSize&&(t.fontSize=e.fontSize),e.color&&(t.color=e.color),e.text&&(t.text=e.text)),t},t.prototype._defineIcon=function(e){var t=e;return"object"==typeof e&&(t.url=e.url,t.size=e.size?new google.maps.Size(e.size[0],e.size[1]):void 0,t.origin=e.origin?new google.maps.Size(e.origin[0],e.origin[1]):void 0,t.anchor=e.anchor?new google.maps.Point(e.anchor[0],e.anchor[1]):void 0,t.scaleSize=e.scaleSize?new google.maps.Size(e.scaleSize[0],e.scaleSize[1]):void 0),t},t.prototype._defineMarkerObj=function(e,t){return{name:t,position:{lat:e.position.lat(),lng:e.position.lng()},marker:e}},t.prototype.addMarker=function(e){var t={},o={},n=this._defineLocation(e.location);t[n.type]=n.location,o.label=this._defineLable(e.label),o.icon=this._defineIcon(e.icon),o.map=this.instance,this._parselocation(t,function(t){o.position=t,this.instance.setCenter(t),this.instance.setZoom(this.zoomLevel);var n=new google.maps.Marker(o),i=e.name?e.name:"marker_"+this.markers.length;this.markers.push(this._defineMarkerObj(n,i))}.bind(this))},t.prototype.addCustomMarker=function(e){var t=e.template||"",o=e.anchor,n=e.draggable,i={},s=this._defineLocation(e.location);i[s.type]=s.location,this._parselocation(i,function(i){this.instance.setCenter(i),this.instance.setZoom(this.zoomLevel);var s=new this.CustomizedMarker(t,i,this,o,n),a=e.name?e.name:"custom_marker_"+this.markers.length;this.markers.push(this._defineMarkerObj(s,a))}.bind(this))},t.prototype.findMarker=function(e){var t=this.markers.map(function(e){return e.name}),o=t.indexOf(e);return this.markers[o]},t.prototype.removeMarker=function(e){var o="";"string"==typeof e&&(o=e),(e.marker instanceof t.CustomizedMarker||e.marker instanceof google.maps.Marker)&&(o=e.name);var n=this.markers.map(function(e){return e.name}),i=n.indexOf(o);-1!==i&&(this.markers[i].marker.setMap(null),this.markers.splice(i,1))},t.prototype.focusMarker=function(e){var o=null;"string"==typeof e&&(o=this.findMarker(e)),(e.marker instanceof t.CustomizedMarker||e.marker instanceof google.maps.Marker)&&(o=e);try{return o&&(this.instance.panTo(o.position),this.instance.setZoom(this.zoomLevel)),o}catch(n){throw"Can't Find Marker In Current Map..."}},t.prototype.getMap=function(){return this.instance},t.prototype.setMapType=function(e){var t=e.toUpperCase();("ROADMAP"===t||"SATELLITE"===t||"TERRAIN"===t||"HYBRID"===t)&&this.instance.setMapTypeId(google.maps.MapTypeId[t])},t.prototype.on=function(e,t){"string"==typeof e&&"function"==typeof t&&google.maps.event.addListener(this.instance,e,function(e){t(e,this.instance,this.markers)}.bind(this))},e.define?e.defind("GMSandbox",[],function(){return t}):e.exports?e.exports.GMSandbox=t:e.GMSandbox=e.GMSandbox||t}(window);